<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tambah Santri - Admin YSQ</title>

  <!-- CSS utama admin (punya temenmu) -->
  <link rel="stylesheet" href="admin.css" />

  <!-- Font Awesome (kalau di desain lama sudah ada, boleh pakai CDN ini) -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  />
</head>

<body>
  <header class="content-header page-header">
    <h1 class="header-title" id="page-content-title">Tambah Santri</h1>
    <div class="admin-profile">
      <span class="admin-text">Form tambah akun santri</span>
    </div>
  </header>

  <section class="stats-cards content-stats-page">
    <div class="stat-card">
      <span class="stat-label">Info</span>
      <span class="stat-value">Isikan data santri di bawah ini</span>
    </div>
  </section>

  <section class="pendaftar-table" style="margin-top:24px;">
    <div class="section-title">Form Tambah Santri</div>

    <form
      id="formTambahSantri"
      class="table-wrapper"
      style="padding:20px; background:#fff; border-radius:12px;"
    >
      <div class="form-group">
        <label>Nama Lengkap</label>
        <input
          type="text"
          id="nama"
          class="search-input"
          placeholder="Nama santri"
          required
        />
      </div>

      <div class="form-group">
        <label>Alamat</label>
        <input
          type="text"
          id="alamat"
          class="search-input"
          placeholder="Alamat lengkap"
          required
        />
      </div>

      <div class="form-group">
        <label>Nomor WhatsApp</label>
        <input
          type="text"
          id="noWa"
          class="search-input"
          placeholder="08xxxxxxxxxx"
          required
        />
      </div>

      <div class="form-group">
        <label>Kelas</label>
        <input
          type="text"
          id="kelas"
          class="search-input"
          placeholder="Contoh: Senin, Selasa, Kelas A, dst"
          required
        />
      </div>

      <div class="form-group">
        <label>Status</label>
        <select id="status" class="search-input" required>
          <option value="AKTIF" selected>AKTIF</option>
          <option value="NONAKTIF">NONAKTIF</option>
        </select>
      </div>

      <button
        type="submit"
        class="action-btn export-btn"
        style="margin-top:16px;"
      >
        Simpan Santri
      </button>
    </form>
  </section>

  <button
    id="back-to-dashboard"
    class="action-btn back-btn"
    style="margin-top: 20px;"
  >
    <i class="fas fa-arrow-left"></i> Kembali ke Dashboard
  </button>

  <!-- Script global (kalau di project lama kamu pakai) -->
  <script src="script.js"></script>

  <script>
    const API_BASE = "http://localhost:8080";

    const form = document.getElementById("formTambahSantri");
    const backBtn = document.getElementById("back-to-dashboard");

    // KIRIM DATA KE BACKEND
    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      const body = {
        nama: document.getElementById("nama").value.trim(),
        alamat: document.getElementById("alamat").value.trim(),
        noWa: document.getElementById("noWa").value.trim(),
        kelas: document.getElementById("kelas").value.trim(),
        status: document.getElementById("status").value,
      };

      if (!body.nama || !body.alamat || !body.noWa || !body.kelas) {
        alert("Semua field wajib diisi.");
        return;
      }

      try {
        const res = await fetch(API_BASE + "/api/admin/santri", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(body),
        });

        if (!res.ok) {
          const errText = await res.text().catch(() => "");
          console.error("Error response:", errText);
          alert("Gagal menyimpan santri (HTTP " + res.status + ").");
          return;
        }

        const data = await res.json();
        console.log("Santri tersimpan:", data);

        alert("Santri berhasil ditambahkan!");
        form.reset(); // kosongkan form

        // opsional: langsung balik ke dashboard
        window.location.href = "dasboard_admin.html";
      } catch (err) {
        console.error(err);
        alert("Gagal terhubung ke server.");
      }
    });

    // TOMBOL KEMBALI
    backBtn.addEventListener("click", () => {
      window.location.href = "dasboard_admin.html";
    });
  </script>

  <style>
    /* Biar form-nya rapi */
    .form-group {
      margin-bottom: 12px;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .form-group label {
      font-weight: 600;
      font-size: 14px;
    }
  </style>
</body>
</html>
